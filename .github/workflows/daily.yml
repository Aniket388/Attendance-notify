name: Daily Attendance Check

on:
  schedule:
    # -----------------------------------------------------------------
    # ‚è∞ SCHEDULE (UTC TIME)
    # India (IST) is UTC + 5:30. We subtract 5:30 from your desired time.
    # -----------------------------------------------------------------

    # ‚òÄÔ∏è MORNING: 7:05 AM IST (01:35 UTC)
    # (Shifted 5 mins to fix "Cold Start" bug)
    - cron: '35 1 * * *'

    # üå§Ô∏è AFTERNOON: 11:35 AM IST (06:05 UTC)
    # (Shifted 5 mins to fix "Cold Start" bug)
    - cron: '5 6 * * *'

    # üåô NIGHT (NEW): 8:30 PM IST (15:00 UTC)
    # (Catches the 6 PM update reliably)
    - cron: '0 15 * * *'

  # Allows manual testing button
  workflow_dispatch:

jobs:
  check-attendance:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout Code
        uses: actions/checkout@v3

      - name: Install Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      - name: Install Libraries
        run: pip install selenium webdriver-manager

      - name: Run Attendance Script
        env:
          COLLEGE_USER: ${{ secrets.COLLEGE_USER }}
          COLLEGE_PASS: ${{ secrets.COLLEGE_PASS }}
          EMAIL_USER: ${{ secrets.EMAIL_USER }}
          EMAIL_PASS: ${{ secrets.EMAIL_PASS }}
          TARGET_EMAIL: ${{ secrets.TARGET_EMAIL }}
        run: python attendance.py
